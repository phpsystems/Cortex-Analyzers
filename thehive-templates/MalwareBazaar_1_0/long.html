<div class="panel panel-info" ng-if="success && content.query_status == 'ok'">
    <div class="panel-heading">
        MalwareBazaar search results for
        <strong>{{artifact.data | fang}}</strong>
    </div>
    <div class="panel-body">
        <div>
            <dl class="dl-horizontal">
                <dt>Hashes</dt>
                <dd class="wrap">
                    md5: {{content.data.md5_hash}}<br />
                    sha256: {{content.data.sha256_hash}}<br />
                    sha1: {{content.data.sha1_hash}}<br />
                    imphash: {{content.data.imphash}}<br />
                    ssdeep: {{content.data.ssdeep}}
                </dd>
                <dt>Reporter</dt>
                <dd>{{content.data.reporter}}</dd>
                <dt>First seen (UTC)</dt>
                <dd>{{content.data.first_seen}}</dd>
                <dt ng-if="content.data.last_seen">Last seen (UTC)</dt>
                <dd ng-if="content.data.last_seen">{{content.data.last_seen}}</dd>
                <dt>Filename</dt>
                <dd>{{content.data.file_name}}</dd>
                <dt>Filetype</dt>
                <dd>{{content.data.file_type}} {{content.data.file_type_mime}}</dd>
                <dt ng-if="content.data.delivery_method">Delivery Method</dt>
                <dd ng-if="content.data.delivery_method">{{content.data.delivery_method}}</dd>
                <dt>Signature</dt>
                <dd><span class="label label-primary">{{content.data.signature}}</span></dd>
                <dt>Tags</dt>
                <dd><span ng-repeat="tag in content.data.tags" class="label label-info">{{tag}}</span></dd>               
            </dl>
        </div>
    </div>
</div>
<div class="panel panel-info" ng-if="success && content.data.intelligence">
    <div class="panel-heading">Intelligence</div>
    <div class="panel-body">
        <div>
            <dl class="dl-horizontal">
                <dt ng-if="content.data.intelligence.clamav">Clamav</dt>
                <dd ng-if="content.data.intelligence.clamav">{{content.data.intelligence.clamav}}</dd>

                <dt ng-if="content.data.intelligence.downloads">Downloads</dt>
                <dd ng-if="content.data.intelligence.downloads">{{content.data.intelligence.downloads}}</dd>

                <dt ng-if="content.data.intelligence.uploads">Uploads</dt>
                <dd ng-if="content.data.intelligence.uploads">{{content.data.intelligence.uploads}}</dd>

                <dt ng-if="content.data.intelligence.mail">Mail</dt>
                <dd ng-if="content.data.intelligence.mail">
                    <span ng-repeat="(k,v) in content.data.intelligence.mail">
                        {{k}} > {{v}}<br/>
                    </span>
                </dd>
            </dl>
        </div>
    </div>
</div>

<div class="panel panel-info" ng-if="success && content.data.file_information">
    <div class="panel-heading">File Information</div>
    <div class="panel-body">
        <p ng-repeat="info in content.data.file_information">
            {{info.context}}: {{info.value}}
        </p>
    </div>
</div>

<div class="panel panel-info" ng-if="success && content.data.comments">
    <div class="panel-heading">Comments</div>
    <div class="panel-body">
        <div>
            <dl class="dl-horizontal">
                <dt ng-repeat-start="comment in content.data.comments">{{comment.display_name}} - {{comment.date_added}}</dt>
                <dd ng-repeat-end>{{comment.comment}}</dd>  
                <hr/>   
                <hr/>   
                <dt ng-if="content.data.comment">Comment</dt>
                <dd ng-if="content.data.comment">{{content.data.comment}}</dd>                           
            </dl>
        </div>
    </div>
</div>

<!-- No results -->
<div class="panel panel-danger" ng-if="content.query_status == 'hash_not_found'">
    <div class="panel-heading">
        <strong>{{artifact.data | fang}}</strong>
    </div>
    <div class="panel-body">
        <dl class="dl-horizontal">
            <dt>
                <i class="fa fa-warning"></i> MalwareBazaar:
            </dt>
            <dd class="wrap">No results</dd>
        </dl>
    </div>
</div>

<!-- General error  -->
<div class="panel panel-danger" ng-if="!success">
    <div class="panel-heading">
        <strong>{{artifact.data | fang}}</strong>
    </div>
    <div class="panel-body">
        <dl class="dl-horizontal" ng-if="content.errorMessage">
            <dt>
                <i class="fa fa-warning"></i> MalwareBazaar:
            </dt>
            <dd class="wrap">{{content.errorMessage}}</dd>
        </dl>
    </div>
</div>
